LI.define("Profile.ComposeDialog");
LI.Profile.ComposeDialog=function(k,b){function e(){f=LI.Dialog();f.contentChangeEvent.subscribe(function(f,e){var g,c,h;e[0]===b.dialogConfig.name&&(g=$("div.send-message-dialog"),g.length&&(c=LI.Controls.getControl(g[0],"ComposeDialog"),h=c.onSendSuccess,c.onSendSuccess=function(a){if(a&&a.responseXML){h.call(c,a);var d=a.responseXML.getElementsByTagName("responseMsg")[0].firstChild.nodeValue;d&&(a=a.responseXML.getElementsByTagName("responseInfo")[0]&&a.responseXML.getElementsByTagName("responseInfo")[0].firstChild.nodeValue,LI.injectAlert(d,
"SUCCESS"===a?"success":"error",null,!1,!0),d=$("#global-error .success p"),d.length&&b.inboxSentLink&&b.inboxSentLinkTitle&&(a=$("\x3ca/\x3e").attr("href",b.inboxSentLink).attr("class","external").html(b.inboxSentLinkTitle),d.append(a)))}else c.onSendFailure(a)}))});f.open(b.dialogConfig)}b=$.extend({inboxSentLink:"",inboxSentLinkTitle:"",dialogConfig:{}},b);var l=$(k),f=null;(function(){l.on("click",function(b){b.preventDefault();e()})})();return{showDialog:e}};(function(){var a=LIModules.requires("jquery");a(document).ready(function(){a("body").on("click",".address-book-edit",function(b){LI.popup(a(this).attr("href"));b.preventDefault()})})})();